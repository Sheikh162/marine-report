generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Report {
  id                      String     @id @default(uuid())
  userId                  String
  createdAt               DateTime   @default(now()) @db.Timestamptz
  updatedAt               DateTime   @updatedAt @db.Timestamptz

  incidentClassification  String?  // for broad classification
  reportedAt              DateTime   @default(now()) @db.Timestamptz
  incidentDate            DateTime
  shipName                String
  imoNumber               String

  flag                    String
  shipType                String
  registrationType        String?
  positionOfVessel        String
  locationOfVessel        String
  //portName   String?           
  areaOfIncident          String?
  //areaDescription String?

  deadweight              String?
  yearBuilt               Int? 
  gt                      String

  draftBefore             String?
  draftAft                String?
  freeboard               String?

  //cargoType   String
  //cargoQty  Int
  cargoTypeQty            String
  bunkers                 String?
  //bunkersQty              Int?
  classificationSociety   String
  lastPortOfCall          String
  nextPortOfCall          String

  piClub                  String
  hullMachineryUnderwriters String?

  conditionLoadedBallast  String?
  totalCrewOnBoard        Int

  ownershipType           String?
  techManagerName         String
  techManagerAddress      String?
  techManagerPhone        String
  techManagerEmail        String

  dpaName                 String
  dpaPhone                String
  dpaMobile               String
  dpaEmail                String

  rpsAgencyName           String?
  rpsAgencyAddress        String?
  rpsAgencyPhone          String?
  rpsAgencyEmail          String?

  rpsAgencyContactName    String?
  rpsAgencyContactPhone   String?
  rpsAgencyContactEmail   String?

  rpslNumber              String?
  localAgencyName         String?
  localAgencyAddress      String?
  localAgencyPhone        String?
  localAgencyEmail        String?
  localAgencyContactName  String?
  localAgencyContactPhone String?
  localAgencyContactEmail String?

  severityOfIncident      String?
  incidentCategory        String
  incidentConsequences    String[]

  deaths                  Int
  injured                 Int
  sickness                Int?
  desertion               Int?
  manOverboardSurvived    Int?

  causalFactors           String?
  summaryIncident         String?
  summaryAction           String?
  lessonsLearnt           String?

  sarRequired             Boolean?
  oilPollutionExtent      String?
  oilSpilledVolume        String?
  weatherConditions       String?
  tidalConditions         String?

  reportedBy              String
  companyName             String
  designation             String
  contactNumber           String
  lastUpdatedBy           String?
  lastUpdatedAt           DateTime? @db.Timestamptz

  mediaUrls               String[]   @default([])

  casualties              Casualty[]
}

model Casualty {
  id                      String     @id @default(uuid())
  reportId                String
  report                  Report     @relation(fields: [reportId], references: [id], onDelete: Cascade)
  createdAt               DateTime   @default(now()) @db.Timestamptz
  updatedAt               DateTime   @updatedAt @db.Timestamptz

  incidentSubCategory     String
  name                    String
  status                  String
  nationality             String
  residentialAddress      String?
  dateOfBirth             DateTime?
  age                     Int?
  rank                    String?
  dateOfJoining           DateTime?

  maritalStatus           String?
  gender                  String
  education               String?

  insuranceCover          String?
  cdcNumber               String?
  cdcPlaceOfIssue         String?
  passportNumber          String?
  passportPlaceOfIssue    String?
  indosNumber             String?
  cocNumber               String?
  cocIssueDate            DateTime?
  cocPlaceOfIssue         String?
  maritimeTraining        String?
  collectiveBargaining    String?
  nextOfKinDetails        String?
  medicalReports          String?
  mortalRemainsStatus     String?
}
